<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>محادثة جماعية</title>
  <style>
    body {
      margin: 0;
      font-family: 'Courier New', monospace;
      background-color: #000;
      color: #0f0;
    }
    #login-screen, #chat-screen {
      display: none;
      padding: 20px;
    }
    #login-screen.active, #chat-screen.active {
      display: block;
    }
    input, button {
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 8px;
      margin: 5px 0;
      width: 100%;
    }
    #messages {
      height: 60vh;
      overflow-y: auto;
      border: 1px solid #0f0;
      padding: 10px;
      margin-bottom: 10px;
    }
    #logout {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #f00;
      color: #fff;
    }
  </style>
</head>
<body><div id="login-screen" class="active">
  <h2>تسجيل الدخول</h2>
  <input type="text" id="username" placeholder="اسم المستخدم" required />
  <input type="password" id="password" placeholder="كلمة المرور" required />
  <input type="password" id="confirm-password" placeholder="تأكيد كلمة المرور" required />
  <button onclick="login()">دخول</button>
</div><div id="chat-screen">
  <button id="logout" onclick="logout()">خروج</button>
  <div id="messages"></div>
  <input type="text" id="message-input" placeholder="اكتب رسالتك..." />
  <button onclick="sendMessage()">إرسال</button>
</div><script>
  const VALID_PASSWORD = "Kr0wldz21";

  function login() {
    const user = document.getElementById("username").value.trim();
    const pass = document.getElementById("password").value;
    const confirm = document.getElementById("confirm-password").value;

    if (!user || !pass || !confirm) return alert("الرجاء ملء جميع الحقول.");
    if (pass !== confirm) return alert("كلمة المرور غير متطابقة.");
    if (pass !== VALID_PASSWORD) return alert("كلمة المرور غير صحيحة.");

    localStorage.setItem("user", user);
    document.getElementById("login-screen").classList.remove("active");
    document.getElementById("chat-screen").classList.add("active");
  }

  function logout() {
    localStorage.clear();
    location.reload();
  }

  function sendMessage() {
    const msgBox = document.getElementById("message-input");
    const msg = msgBox.value.trim();
    if (!msg) return;

    const user = localStorage.getItem("user") || "مجهول";
    const msgEl = document.createElement("div");
    msgEl.textContent = `${user}: ${msg}`;
    document.getElementById("messages").appendChild(msgEl);

    msgBox.value = "";
    msgBox.focus();

    const messagesDiv = document.getElementById("messages");
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  // تسجيل خروج عند الرجوع
  window.onpopstate = function () {
    logout();
  };
</script></body>
</html>
